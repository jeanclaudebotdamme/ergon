(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[956],{3569:function(e,t,s){Promise.resolve().then(s.bind(s,7604))},7604:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var a=s(7437),d=s(2265),l=s(4196),o=s(3119),n=s(2141);function c(e){let t={totalInput:0,totalOutput:0,totalCacheRead:0,totalCacheWrite:0,totalTokens:0,totalCost:0,byProvider:{}};for(let s of e){t.totalInput+=s.input_tokens,t.totalOutput+=s.output_tokens,t.totalCacheRead+=s.cache_read_tokens||0,t.totalCacheWrite+=s.cache_write_tokens||0,t.totalTokens+=s.total_tokens,t.totalCost+=s.cost_usd;let e=s.provider.toLowerCase();t.byProvider[e]||(t.byProvider[e]={input:0,output:0,cacheRead:0,cacheWrite:0,tokens:0,cost:0,models:{}});let a=t.byProvider[e];a.input+=s.input_tokens,a.output+=s.output_tokens,a.cacheRead+=s.cache_read_tokens||0,a.cacheWrite+=s.cache_write_tokens||0,a.tokens+=s.total_tokens,a.cost+=s.cost_usd,a.models[s.model]||(a.models[s.model]={input:0,output:0,tokens:0,cost:0}),a.models[s.model].input+=s.input_tokens,a.models[s.model].output+=s.output_tokens,a.models[s.model].tokens+=s.total_tokens,a.models[s.model].cost+=s.cost_usd}return t}function i(e){return e.toLocaleString()}function r(e){return"$".concat(e.toFixed(4))}function x(e){let{title:t,stats:s,isLoading:d}=e,l=Object.keys(s.byProvider).sort();return d?(0,a.jsxs)("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-text mb-4",children:t}),(0,a.jsx)("div",{className:"text-text-muted",children:"Loading..."})]}):(0,a.jsxs)("div",{className:"bg-surface rounded-xl p-6 border border-border",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-text mb-4",children:t}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-surface-secondary rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-text-muted mb-1",children:"Input Tokens"}),(0,a.jsx)("div",{className:"text-xl font-semibold text-text",children:i(s.totalInput)})]}),(0,a.jsxs)("div",{className:"bg-surface-secondary rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-text-muted mb-1",children:"Output Tokens"}),(0,a.jsx)("div",{className:"text-xl font-semibold text-text",children:i(s.totalOutput)})]}),(0,a.jsxs)("div",{className:"bg-surface-secondary rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-text-muted mb-1",children:"Total Tokens"}),(0,a.jsx)("div",{className:"text-xl font-semibold text-text",children:i(s.totalTokens)})]}),(0,a.jsxs)("div",{className:"bg-surface-secondary rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-text-muted mb-1",children:"Cost"}),(0,a.jsx)("div",{className:"text-xl font-semibold text-accent-light",children:r(s.totalCost)})]})]}),(s.totalCacheRead>0||s.totalCacheWrite>0)&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"bg-surface-secondary rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-text-muted mb-1",children:"Cache Read"}),(0,a.jsx)("div",{className:"text-lg font-medium text-text",children:i(s.totalCacheRead)})]}),(0,a.jsxs)("div",{className:"bg-surface-secondary rounded-lg p-3",children:[(0,a.jsx)("div",{className:"text-xs text-text-muted mb-1",children:"Cache Write"}),(0,a.jsx)("div",{className:"text-lg font-medium text-text",children:i(s.totalCacheWrite)})]})]}),l.length>0&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-text-muted uppercase tracking-wider",children:"By Provider"}),l.map(e=>{let t=s.byProvider[e],d=Object.keys(t.models).sort();return(0,a.jsxs)("div",{className:"bg-surface-secondary rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:function(e){let t=e.toLowerCase();return"anthropic"===t?"#7cb88a":"moonshot"===t||t.includes("kimi")?"#a0a0d0":"#888"}(e)}}),(0,a.jsx)("span",{className:"font-medium text-text",children:function(e){let t=e.toLowerCase();return"anthropic"===t?"Anthropic":"moonshot"===t||t.includes("kimi")?"Moonshot / Kimi":e.charAt(0).toUpperCase()+e.slice(1)}(e)}),(0,a.jsx)("span",{className:"text-sm text-text-muted ml-auto",children:r(t.cost)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-text-muted",children:"Input"}),(0,a.jsx)("div",{className:"text-sm text-text",children:i(t.input)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-text-muted",children:"Output"}),(0,a.jsx)("div",{className:"text-sm text-text",children:i(t.output)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-xs text-text-muted",children:"Total"}),(0,a.jsx)("div",{className:"text-sm text-text",children:i(t.tokens)})]})]}),d.length>0&&(0,a.jsxs)("div",{className:"mt-3 pt-3 border-t border-border",children:[(0,a.jsx)("div",{className:"text-xs text-text-muted mb-2",children:"Models"}),(0,a.jsx)("div",{className:"space-y-2",children:d.map(e=>{let s=t.models[e];return(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-text-muted truncate flex-1",children:e}),(0,a.jsxs)("span",{className:"text-text mx-4",children:[i(s.tokens)," tokens"]}),(0,a.jsx)("span",{className:"text-accent-light",children:r(s.cost)})]},e)})})]})]},e)})]}),0===l.length&&(0,a.jsx)("div",{className:"text-center py-8 text-text-muted",children:"No usage data for this period"})]})}function m(){let[e,t]=(0,d.useState)(!0),[s,i]=(0,d.useState)(null),[r,m]=(0,d.useState)([]),[u,h]=(0,d.useState)([]),[p,g]=(0,d.useState)([]);(0,d.useEffect)(()=>{!async function(){try{t(!0),i(null);let e=new Date,s=new Date(e);s.setHours(0,0,0,0);let a=new Date(e);a.setDate(a.getDate()-7),a.setHours(0,0,0,0);let d=new Date(e);d.setDate(1),d.setHours(0,0,0,0);let[l,o,c]=await Promise.all([(0,n._9)(s.toISOString(),e.toISOString()),(0,n._9)(a.toISOString(),e.toISOString()),(0,n._9)(d.toISOString(),e.toISOString())]);m(l),h(o),g(c)}catch(e){i(e instanceof Error?e.message:"Failed to load usage data")}finally{t(!1)}}()},[]);let j=(0,d.useMemo)(()=>c(r),[r]),v=(0,d.useMemo)(()=>c(u),[u]),b=(0,d.useMemo)(()=>c(p),[p]);return(0,a.jsxs)("div",{className:"min-h-screen bg-background flex flex-col",children:[(0,a.jsx)(l.Z,{title:"Token Usage"}),(0,a.jsxs)("main",{className:"flex flex-1 overflow-hidden",style:{height:"calc(100vh - 73px)"},children:[(0,a.jsx)(o.Z,{activeView:"usage"}),(0,a.jsxs)("section",{className:"flex-1 overflow-y-auto p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-semibold tracking-tight text-text",children:"Token Usage"}),(0,a.jsx)("p",{className:"text-text-muted mt-1",children:"Track API token consumption and costs across providers"})]}),s&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-700 rounded-lg text-red-400",children:["Error loading usage data: ",s]}),(0,a.jsxs)("div",{className:"grid gap-6 max-w-4xl",children:[(0,a.jsx)(x,{title:"Today",stats:j,isLoading:e}),(0,a.jsx)(x,{title:"This Week (7 days)",stats:v,isLoading:e}),(0,a.jsx)(x,{title:"This Month",stats:b,isLoading:e})]})]})]})]})}}},function(e){e.O(0,[53,448,858,971,117,744],function(){return e(e.s=3569)}),_N_E=e.O()}]);